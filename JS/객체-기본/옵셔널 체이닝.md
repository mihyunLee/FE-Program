# 옵셔널 체이닝 '?.'



> 출처 - [**모던 JS 튜토리얼**](https://ko.javascript.info/)을 보고 정리한 글입니다.



<br>



옵셔널 체이닝(optional chaining) `?.`을 사용하면 프로퍼티가 없는 중첩 객체를 에러 없이 안전하게 접근할 수 있다.



## 1. 옵셔널 체이닝이 필요한 이유

- 객체 프로퍼티에 값이 없을 때 접근하려는 경우 에러 발생

```javascript
let user = {}; // 주소 정보가 없는 사용자

alert(user.address.street); // TypeError: Cannot read property 'street' of undefined
```

- 자바스크립트를 사용해 페이지에 존재하지 않는 요소에 접근할 경우 에러 발생

```javascript
// querySelector(...) 호출 결과가 null인 경우 에러 발생
let html = document.querySelector('.my-element').innerHTML;
```



옵셔널 체이닝이 등장하기 전까지는 `&&` 연산자로 해결하곤 했다.

```javascript
let user = {}; // 주소 정보가 없는 사용자

alert( user && user.address && user.address.street ); // undefined, 에러가 발생하지 않는다.
```

`&&`를 사용할 경우 코드가 길어진다는 단점이 있다.

<br>

## 2. 옵셔널 체이닝의 등장

`?.` 앞의 평가 대상이 `undefined`나 `null`이면  평가를 멈추고 `undefined`를 반환한다.

```javascript
let user = {}; // 주소 정보가 없는 사용자

alert( user?.address?.street ); // undefined, 에러가 발생하지 않는다.
```

`user?.address`를 읽으면 `user`객체가 존재하지 않더라도 에러가 발생하지 않는다.

<br>

### ⚠️ 주의사항

- 옵셔널 체이닝을 남용하지 않기
  - `?.`는 존재하지 않아도 괜찮은 대상에만 사용해야 한다.
  - 위 예시에서 `address`는 필수값이 아니므로 옵셔널 체이닝을 사용해도 된다. 그렇지만 `user`처럼 필수값의 경우에는 값을 할당하지 않았다면 바로 에러를 발견할 수 있도록 해야하기 때문에 옵셔널 체이닝을 사용하면 안된다.
- `?.` 앞의 변수는 꼭 선언되어 있어야 한다.
  - 변수 `user`가 선언되어 있지 않으면 `user?.anyting` 평가시 에러가 발생한다.

<br>

## 3. ?.()와 ?.[]

`?.`은 연산자가 아니다. `?.`은 함수나 대괄호와 함께 동작하는 특별한 문법 구조체이다.



```javascript
let user1 = {
  admin() {
    alert("관리자 계정입니다.");
  }
}

let user2 = {};

user1.admin?.(); // 관리자 계정입니다.
user2.admin?.();
```

user 객체는 무조건 존재하기 때문에 `.`만 사용해 접근하고 `admin`에는 `?.()`를 사용해 접근한다.

user2엔 `admin`이 존재하지 않음에도 에러 없이 평가를 종료한다.

`.`대신 대괄호`[]`를 사용해 객체 프로퍼티에 접근하는 경우엔 `?.[]`를 사용할 수도 있다.

<br>

### ⚠️`?.`는 읽거나 삭제할 경우에는 사용할 수 있지만 쓰기에는 사용할 수 없다.

```javascript
// (1) 프로퍼티 삭제
delete user?.name; // user가 존재하면 user.name을 삭제한다.

// (2) 프로퍼티 추가
user?.name = "Violet"; // SyntaxError: Invalid left-hand side in assignment
```

쓰기에 에러가 나는 이유는 `user?.name = "Violet"`는 `user?.name = "Violet"`이 되기 때문이다.