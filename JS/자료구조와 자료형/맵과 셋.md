# 맵과 셋



> 출처 - [모던 JS 튜토리얼](****https://ko.javascript.info/****) 을 보고 정리한 글입니다.



<br>



## 1. 맵(Map)

**맵(Map)** 은 키가 있는 데이터를 저장한다는 점에서 `객체`와 유사하지만, 키에 다양한 자료형을 허용한다는 차이가 있다.

| 메서드 및 프로퍼티    | 설명                                                         |
| --------------------- | ------------------------------------------------------------ |
| `new Map()`           | 맵 생성                                                      |
| `map.set(key, value)` | `key`를 이용해 `value`를 저장한다.                           |
| `map.get(key)`        | `key`에 해당하는 값을 반환하고, `key`가 존재하지 않으면 `undefined`를 반환한다. |
| `map.has(key)`        | `key`가 존재하면 `true`, 존재하지 않으면 `false`를 반환한다. |
| `map.delete(key)`     | `key`에 해당하는 값 삭제                                     |
| `map.clear()`         | 맵 안의 모든 요소를 제거한다.                                |
| `map.size`            | 요소의 개수를 반환한다.                                      |

<br>

> `map[key]`는 Map 을 쓰는 바른 방법이 아니다.

`map[key] = 2`로 값을 설정하는 것 같이 `map[key]`를 사용할 수 있다. 하지만 `map`을 일반 객체처럼 취급하게 되어 여러 제약이 생기게 된다.

`map`을 사용할 땐 `map`전용 메서드인 `set`, `get` 등을 사용해야만 한다.

<br>

### 맵은 키로 객체를 허용한다.

```javascript
let john = { name: "John" };

// map 생성
let visitsCountMap = new Map();

// 객체 john을 맵의 키로 사용
visitsCountMap.set(john, 123);

alert( visitsCountMap.get(john) ); // 123

// 객체 생성
let visitsCountObj = {};

// 객체 john을 객체의 키로 사용
visitsCountObj[john] = 123;

// 원하는 값(123)을 얻으려면 아래와 같이 키가 들어갈 자리에 `object Object`를 써줘야한다.
alert( visitsCountObj["[object Object]"] ); // 123
```

객체는 모든 키를 문자형으로 변환시키기 때문에 `john`은 문자형으로 변형되어 `"[object Object]"`가 된다.

<br>

### 맵은 키로 `NaN`도 쓸 수 있다.

맵은  [SameValueZero](https://tc39.github.io/ecma262/#sec-samevaluezero) 알고리즘을 사용해 등가 여부를 확인한다. 이 알고리즘은 일치 연산자 `===`와 거의 유사하지만, `NaN`과 `NaN`을 같다고 취급하는 것에서 차이가 있다.

따라서 맵에서는 `NaN`도 키로 쓸 수 있다.

<br>

### 체이닝

`map.set`을 호출할 때마다 맵 자신이 반환되기 때문에 체이닝(chaining) 할 수 있다.

```javascript
map.set('1', 'str1')
  .set(1, 'num1')
  .set(true, 'bool1');
```

<br>

## 2. 맵의 요소에 반복 작업하기

| 메서드          | 설명                                                         |
| --------------- | ------------------------------------------------------------ |
| `map.keys()`    | 각 요소의 `키`를 모은 이터러블 객체를 반환한다.              |
| `map.values()`  | 각 요소의 `값`을 모은 이터러블 객체를 반환한다.              |
| `map.entries()` | 요소의 `[키, 값]`을 한 쌍으로 하는 이터러블 객체를 반환한다. |

`맵`은 삽입 순서를 기억해서 객체와는 다르게 삽입된 순서대로 순회한다.

그리고 `배열`과 유사하게 내장 메서드 `forEach`도 지원한다.

<br>

## 3. Object.entries: 객체를 맵으로 바꾸기

각 요소가 키-값 쌍인 **배열**이나 **이터러블 객체**를 초기화 용도로 `맵`에 전달해 새로운 `맵`을 만들 수 있다.

```javascript
// 각 요소가 [키, 값] 쌍인 배열
let map = new Map([
  ['1',  'str1'],
  [1,    'num1'],
  [true, 'bool1']
]);

alert( map.get('1') ); // str1
```



일반적인 객체는 내장 메서드 `Object.entries`를 사용해서 맵으로 만들 수 있다.

- `Object.entries`
  - 객체의 키-값 쌍을 `[key, value]`를 요소로 가지는 배열을 반환한다.

```javascript
let obj = {
  name: "John",
  age: 30
};

let map = new Map(Object.entries(obj));

alert( map.get('name') ); // John
```

<br>

## 4. Object.fromEntries: 맵을 객체로 바꾸기

맵을 객체로 바꾸려면 내장 메서드 `Object.fromEntries`를 사용하면 된다.

- `Object.fromEntries`
  - 각 요소가 `[key, value]` 쌍인 배열을 객체로 바꿔준다.

```javascript
let map = new Map();
map.set('banana', 1);
map.set('orange', 2);
map.set('meat', 4);

let obj = Object.fromEntries(map.entries()); // 맵을 일반 객체로 변환

// obj = { banana: 1, orange: 2, meat: 4 }

alert(obj.orange); // 2
```

`map.entries()`를 호출하면 맵의 `[key, value]`를 요소로 가지는 이터러블을 반환하기 때문에 `Object.fromEntries`를 사용해서 객체로 변환할 수 있다.

`Object.fromEntries`는 인수로 이터러블 객체를 받기 때문에 `map.entries()` 대신에 `map`으로 짧게 작성해도 된다.

<br>

## 5. 셋(Set)

`셋(Set)`은 중복을 허용하지 않는 값을 모아놓은 컬렉션이다. 셋 내에 특정 값이 존재하면 해당 값은 저장되지 않는다.

| 메서드              | 설명                                                         |
| ------------------- | ------------------------------------------------------------ |
| `new Set(iterable)` | 셋 생성. 배열이 아닌 이터러블 객체를 전달받으면 그 안의 값을 복사해 셋에 넣어준다. |
| `set.add(value)`    | 값을 추가하고 셋 자신을 반환한다.                            |
| `set.delete(value)` | 값을 제거한다. 호출 시점에 제거에 성공하면 `true`, 아니면 `false`를 반환한다. |
| `set.has(value)`    | 셋 내에 값이 존재하면 `true`, 아니면 `false`를 반환한다.     |
| `set.clear()`       | 셋을 비운다.                                                 |
| `set.size`          | 셋에 몇 개의 값이 있는지 세준다.                             |

배열은 `arr.find`로 중복 값 여부를 확인할 수 있다. 하지만 `arr.find`는 배열 내 요소 전체를 순회하기 때문에 셋보다 성능 면에서 떨어진다.

<br>

## 6. 셋의 값에 반복 작업하기

- `for..of`나 `forEach`를 사용하면 셋의 값을 대상으로 반복 작업을 수행할 수 있다.

```javascript
let set = new Set(["oranges", "apples", "bananas"]);

// ① for..of
for (let value of set) alert(value); 

// ② forEach
set.forEach((value, valueAgain, set) => { 
  alert(value);
});
```

`forEach`에 쓰인 콜백 함수는 세 개의 인수를 받는데, 첫 번째와 두 번째 인수가 동일한 값으로 등장한다.

맵의 `forEach`에 쓰인 콜백이 세 개의 인수를 받을 때를 위해 이와 같이 구현되었다. 따라서 `맵`↔`셋` 교체가 쉽다.

- 반복을 위한 `셋` 메서드

| 메서드          | 설명                                                         |
| --------------- | ------------------------------------------------------------ |
| `set.keys()`    | 셋 내의 모든 값을 포함하는 이터러블 객체를 반환한다.         |
| `set.values()`  | `set.keys`와 동일한 작업을 한다. *(맵과의 호환성을 위해 만들어진 메서드)* |
| `set.entries()` | 셋 내의 각 값을 `[value, value]` 배열을 포함하는 이터러블 객체를 반환한다. <br />*(맵과의 호환성을 위해 만들어진 메서드)* |

