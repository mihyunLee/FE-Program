# 구조 분해 할당



> 출처 - [**모던 JS 튜토리얼**](https://ko.javascript.info/)을 보고 정리한 글입니다.



<br>



> **구조 분해 할당(destructuring assignment) 이란?**

객체나 배열을 복사한 이후에 변수로 분해할 수 있게 해주는 문법이다.

<br>

## 1. 배열 분해하기

```javascript
let arr = ["Bora", "Lee"]

// 구조 분해 할당을 이용해
// firstName엔 arr[0]을
// surname엔 arr[1]을 할당
let [firstName, surname] = arr;

alert(firstName); // Bora
alert(surname);  // Lee
```

인덱스를 이용해 배열에 접근하지 않고도 값을 사용할 수 있다.

<br>

- `split`같은 반환 값이 **배열**인 메서드 사용하기

```javascript
let [firstName, surname] = "Bora Lee".split(' ');
```

<br>

- 쉼표로 필요하지 않은 배열 요소 버리기

```javascript
let [firstName, , title] = ["Julius", "Caesar", "Consul", "of the Roman Republic"];

alert( title ); // Consul
```

두 번째 요소인 Caesar는 생략되고, 세 번째 요소는 `title` 변수에 할당되었다. 네 번째 요소 역시 할당할 변수가 없기 때문에 생략된다.

<br>

- `Object.entries`와 구조 분해를 조합하여 객체의 키와 값으로 분해 할당할 수 있다.

```javascript
let user = {
  name: "John",
  age: 30
};

// 객체의 키와 값 순회하기
for (let [key, value] of Object.entries(user)) {
  alert(`${key}:${value}`); // name:John, age:30이 차례대로 출력
}
```

<br>

- 할당 연산자 우측엔 배열뿐만 아니라 모든 이터러블이 올 수 있다.
- 할당 연산자 좌측엔 객체 프로퍼티와 같이 할당할 수 있는 것이라면 어떤 것이든 올 수 있다.

<br>

## 2. '...'로 나머지 요소 가져오기

점 세 개 `...`를 붙인 매개변수 하나를 추가하면 `나머지`(rest) 요소를 가져올 수 있다.

```javascript
let [name1, name2, ...rest] = ["Julius", "Caesar", "Consul", "of the Roman Republic"];

alert(name1); // Julius
alert(name2); // Caesar

alert(rest[0]); // Consul
alert(rest[1]); // of the Roman Republic
alert(rest.length); // 2
```

`rest`는 나머지 배열 요소들이 저장된 새로운 배열이 된다.

<br>

### 기본값

할당할 값이 없으면 `undefined`로 취급되기 때문에 할당하고자 하는 변수의 개수가 분해하고자 하는 배열의 길이보다 크더라도 에러가 발생하지 않는다.

```javascript
let [firstName, surname] = [];

alert(firstName); // undefined
alert(surname); // undefined
```

<br>

`=`를 이용하면 기본값을 설정할 수 있다. 기본값으로 표현식이나 함수를 설정하면 할당할 값이 없을 때 표현식이 평가되거나 함수가 호출된다.

```javascript
let [surname = prompt('성을 입력하세요.'), name = prompt('이름을 입력하세요.')] = ["김"];

alert(surname); // 김 (배열에서 받아온 값)
alert(name);    // prompt에서 받아온 값
```

<br>

## 3. 객체 분해하기

- 기본 문법

```javascript
let {var1, var2} = {var1:…, var2:…}
```

할당 연산자 우측엔 분해하고자 하는 객체를, 좌측엔 상응하는 객체 프로퍼티의 `패턴`을 넣는다.



```javascript
let options = {
  title: "Menu",
  width: 100,
  height: 200
};

let {title, width, height} = options;

alert(title);  // Menu
alert(width);  // 100
alert(height); // 200
```

`options.title`과 `options.width`, `options.height`에 저장된 값이 상응하는 변수에 할당된다.



```javascript
let {height, width, title} = { title: "Menu", height: 200, width: 100 }
```

상응하는 변수에 할당되기 때문에 순서가 바뀌어도 동일하게 동작한다.

<br>

- 콜론(`:`)을 사용하여 객체 프로퍼티를 프로퍼티 키와 다른 이름의 변수에 저장하기

```javascript
let options = {
  title: "Menu",
  width: 100,
  height: 200
};

// { 객체 프로퍼티: 목표 변수 }
let {width: w, height: h, title} = options;

alert(title);  // Menu
alert(w);      // 100
alert(h);      // 200
```

<br>

- `=`을 사용해 기본값을 설정하기

```javascript
let options = {
  title: "Menu"
};

let {width = 100, height = 200, title = prompt("title?")} = options;

alert(title);  // Menu
alert(width);  // 100
alert(height); // 200
```

<br>

- 원하는 정보만 뽑아오기

```javascript
let options = {
  title: "Menu",
  width: 100,
  height: 200
};

// title만 변수로 뽑아내기
let { title } = options;

alert(title); // Menu
```

<br>

### 나머지 패턴 '...'

나머지 패턴(rest pattern)을 사용하면 배열에서 했던 것처럼 나머지 프로퍼티를 어딘가에 할당할 수 있다.

```javascript
let options = {
  title: "Menu",
  height: 200,
  width: 100
};

let {title, ...rest} = options;

// title엔 "Menu", rest엔 {height: 200, width: 100}이 할당된다.
alert(rest.height);  // 200
alert(rest.width);   // 100
```

<br>

### `let` 없이 사용하기

`let`으로 새로운 변수를 선언하지 않고 기존에 있던 변수에 분해한 값일 할당할 땐 코드 블록을 괄호`()`로 감싼다.

```javascript
let title, width, height;

// SyntaxError: Unexpected token '=' 이라는 에러가 아랫줄에서 발생한다.
{title, width, height} = {title: "Menu", width: 200, height: 100};
```

자바스크립트는 표현식 안에 있지 않으면서 주요 코드 흐름 상에 있는 `{...}`를 코드 블록으로 인식하기 때문에 위 코드에 에러가 발생한다. 코드 블록의 용도는 문(statement)을 묶는 것이기 때문에 할당문을 괄호`(...)`로 감싸 자바스크립트가 `{...}`를 코드 블록이 아닌 표현식으로 해석하게 한다.

```javascript
let title, width, height;

({title, width, height} = {title: "Menu", width: 200, height: 100});

alert( title ); // Menu
```

<br>

## 4. 중첩 구조 분해

객체나 배열이 다른 객체나 배열을 포함하는 경우, 좀 더 복잡한 패턴을 사용하면 중첩 배열이나 객체의 정보를 추출할 수 있다. 이를 *중첩 구조 분해*(nested destructuring)라고 부른다.

```javascript
let options = {
  size: {
    width: 100,
    height: 200
  },
  items: ["Cake", "Donut"],
  extra: true
};

// 코드를 여러 줄에 걸쳐 작성해 의도하는 바를 명확히 드러냄
let {
  size: {
    width,
    height
  },
  items: [item1, item2],
  title = "Menu" // 분해하려는 객체에 title 프로퍼티가 없으므로 기본값을 사용함
} = options;

alert(title);  // Menu
alert(width);  // 100
alert(height); // 200
alert(item1);  // Cake
alert(item2);  // Donut
```

<br>

## 5. 똑똑한 함수 매개변수

매개변수 모두를 객체에 모아 함수에 전달해 함수가 전달받은 객체를 분해하여 변수에 할당하면, 매개변수가 많아졌을 때 가독성이 떨어지는 것을 해결할 수 있다.

```javascript
// 함수에 전달할 객체
let options = {
  title: "My menu",
  items: ["Item1", "Item2"]
};

// 똑똑한 함수는 전달받은 객체를 분해해 변수에 즉시 할당함
function showMenu({title = "Untitled", width = 200, height = 100, items = []}) {
  // title, items – 객체 options에서 가져옴
  // width, height – 기본값
  alert( `${title} ${width} ${height}` ); // My Menu 200 100
  alert( items ); // Item1, Item2
}

showMenu(options);
```

<br>

### ⚠️ 함수 매개변수를 구조 분해할 땐, 반드시 인수가 전달된다고 가정하고 사용되기 때문에 유의해야한다.

```javascript
showMenu({}); // 모든 인수에 기본값이 할당된다.

showMenu(); // 에러가 발생할 수 있다.
```

이 문제를 해결하려면 빈 객체 `{}`를 인수 전체의 기본값으로 만들면 된다.

```javascript
function showMenu({ title = "Menu", width = 100, height = 200 } = {}) {
  alert( `${title} ${width} ${height}` );
}

showMenu(); // Menu 100 200
```

