# 화살표 함수 다시 살펴보기



> 출처 - [**모던 JS 튜토리얼**](**https://ko.javascript.info/**) 을 보고 정리한 글입니다.



<br>



> 화살표 함수를 쓰는 용도

화살표 함수(arrow function)는 함수를 짧게 쓰기 위한 용도로만 쓰이는 것이 아니다.

어딘가에 함수를 전달하게 되면 함수의 컨텍스트를 잃을 수 있다. 이럴 때 화살표 함수를 사용하면 현재 컨텍스트를 잃지 않는다.

<br>

## 1. 화살표 함수에는 'this'가 없다.

- 화살표 함수 본문에서 `this`에 접근하면, 외부에서 값을 가져온다. 

```javascript
let group = {
  title: "1모둠",
  students: ["보라", "호진", "지민"],

  showList() {
    this.students.forEach(
      student => alert(this.title + ': ' + student)
    );
  }
};

group.showList();
```

`forEach`에서 사용한 화살표 함수 본문 안의 `this.title`은 화살표 함수 밖에 있는 메서드인 `showList()`가 가리키는 대상과 동일하다. 즉 `this.title`은 `group.title`과 같다.

<br>

```javascript
let group = {
  title: "1모둠",
  students: ["보라", "호진", "지민"],

  showList() {
    this.students.forEach(function(student) {
      // TypeError: Cannot read property 'title' of undefined
      alert(this.title + ': ' + student)
    });
  }
};

group.showList();
```

만약 `forEach`에서 화살표 함수 대신 일반 함수를 사용했다면  `forEach`에 전달되는 함수의 `this`가 `undefined`된다. 따라서 `this.title`은 `undefined.title`이 되어 에러가 발생한다.

<br>

#### ⚠️ 화살표 함수는 `new`와 함께 실행될 수 없다.

- `this`가 없기 때문에 화살표 함수는 생성자 함수로 사용할 수 없다.

<br>

#### 화살표 함수 vs. bind

- `.bind(this)`를 사용해서 일반 함수 호출 - `.bind(this)`는 함수의 한정된 버전(bound version)을 만든다.
- 화살표 함수는 어떤 것도 바인딩시키지 않는다. 화살표 함수에서 `this`를 사용하면 일반 변수 서칭과 마찬가지로 `this`의 값을 외부 렉시컬 환경에서 찾는다.

<br>

## 2. 화살표 함수엔 'arguments'가 없다.

- 화살표 함수는 모든 인수에 접근할 수 있게 해주는 유사 배열 객체 `arguments`를 지원하지 않는다.

- 이러한 특징은 현재 `this` 값과 `arguments` 정보를 함께 실어 호출을 포워딩 해주는 데코레이터를 만들 때 유용하게 사용된다.

```javascript
// (1) - 화살표 함수를 사용한 데코레이터 함수
function defer(f, ms) {
  return function() {
    setTimeout(() => f.apply(this, arguments), ms)
  };
}

function sayHi(who) {
  alert('안녕, ' + who);
}

let sayHiDeferred = defer(sayHi, 2000);
sayHiDeferred("철수"); // 2초 후 "안녕, 철수" 출력

// (2) 일반 데코레이터 함수
function defer(f, ms) {
  return function(...args) {
    let ctx = this;
    setTimeout(function() {
      return f.apply(ctx, args);
    }, ms);
  };
}
```

일반 함수에선 `setTimeout`에 넘겨주는 콜백 함수에서 사용할 변수 `ctx`와 `args`를 반드시 만들어줘야 한다.

